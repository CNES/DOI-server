<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_242) on Thu Feb 27 05:22:29 CET 2020 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>fr.cnes.doi.resource.mds (Digital Object Identifier Server 1.0.3 API)</title>
<meta name="date" content="2020-02-27">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="fr.cnes.doi.resource.mds (Digital Object Identifier Server 1.0.3 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../fr/cnes/doi/resource/citation/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../../fr/cnes/doi/security/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?fr/cnes/doi/resource/mds/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;fr.cnes.doi.resource.mds</h1>
<div class="docSummary">
<div class="block">Provides resources for Meta Data Store application.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../fr/cnes/doi/resource/mds/BaseMdsResource.html" title="class in fr.cnes.doi.resource.mds">BaseMdsResource</a></td>
<td class="colLast">
<div class="block">Base resource for the different resources.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../fr/cnes/doi/resource/mds/DoiResource.html" title="class in fr.cnes.doi.resource.mds">DoiResource</a></td>
<td class="colLast">
<div class="block">DOI resource to retrieve the landing page for a given DOI.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../fr/cnes/doi/resource/mds/DoisResource.html" title="class in fr.cnes.doi.resource.mds">DoisResource</a></td>
<td class="colLast">
<div class="block">Resource to handle a collection of DOI.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../fr/cnes/doi/resource/mds/MediaResource.html" title="class in fr.cnes.doi.resource.mds">MediaResource</a></td>
<td class="colLast">
<div class="block">Resource to handle the Media.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../fr/cnes/doi/resource/mds/MetadataResource.html" title="class in fr.cnes.doi.resource.mds">MetadataResource</a></td>
<td class="colLast">
<div class="block">Resources to handle a metadata.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../fr/cnes/doi/resource/mds/MetadatasResource.html" title="class in fr.cnes.doi.resource.mds">MetadatasResource</a></td>
<td class="colLast">
<div class="block">Resource to handle a collection of metadata.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package fr.cnes.doi.resource.mds Description">Package fr.cnes.doi.resource.mds Description</h2>
<div class="block">Provides resources for Meta Data Store application.

 The <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html" title="class in fr.cnes.doi.application"><code>DoiMdsApplication</code></a> is the main DOI
 <a href="../../../../../fr/cnes/doi/application/package-summary.html"><code>application</code></a> that brings together a set of
 resources handling the life of DOIs.

 <p>
 An application is instantiated only once when the server starts. On the
 contrary a resource is instantiated at each call. The <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html" title="class in fr.cnes.doi.application"><code>DoiMdsApplication</code></a>
 <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#createRouter--"><code>routes</code></a> the
 different resources according to an URI.

 <ul>
 <li>the <a href="../../../../../fr/cnes/doi/resource/mds/DoisResource.html" title="class in fr.cnes.doi.resource.mds"><code>DoisResource</code></a> is routed by the URI
 <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#DOI_URI">"/dois"</a></li>
 <li>the <a href="../../../../../fr/cnes/doi/resource/mds/DoiResource.html" title="class in fr.cnes.doi.resource.mds"><code>DoiResource</code></a> is routed by the URI  <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#DOI_URI">"/dois"</a>
 <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#DOI_NAME_URI">"/{doiName}"</a></li>
 <li>the <a href="../../../../../fr/cnes/doi/resource/mds/MetadatasResource.html" title="class in fr.cnes.doi.resource.mds"><code>MetadatasResource</code></a> is routed by the
 URI <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#METADATAS_URI">"/metadata"</a></li>
 <li>the <a href="../../../../../fr/cnes/doi/resource/mds/MetadataResource.html" title="class in fr.cnes.doi.resource.mds"><code>MetadataResource</code></a> is routed by the
 URI  <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#METADATAS_URI">"/metadata"</a>
 <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#DOI_NAME_URI">"/{doiName}"</a></li>
 <li>the <a href="../../../../../fr/cnes/doi/resource/mds/MediaResource.html" title="class in fr.cnes.doi.resource.mds"><code>MediaResource</code></a> is routed by the URI  <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#MEDIA_URI">"/media"</a>
 <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#DOI_NAME_URI">"/{doiName}"</a></li>
 </ul>

 Some of the above resources are protected by several mechanism. This
 mechanism is defined as a pipeline:
 <ul>
 <li>Request: --&gt;
 <a href="../../../../../fr/cnes/doi/application/AbstractApplication.html#createAuthenticator--"><code>Basic auth</code></a>(optional)
 --&gt;<a href="../../../../../fr/cnes/doi/application/AbstractApplication.html#createTokenAuthenticator--"><code>Token auth</code></a>
 (optional)
 --&gt;<a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#createMethodAuthorizer--"><code>Method auth</code></a>
 --&gt;<a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html#createRouter--"><code>router</code></a></li>
 <li>Response: &lt;--  <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.SecurityPostProcessingFilter.html" title="class in fr.cnes.doi.application"><code>SecurityPostProcessing</code></a> &lt;---</li>
 </ul>

 The <a href="../../../../../fr/cnes/doi/client/ClientMDS.html" title="class in fr.cnes.doi.client"><code>clientMDS</code></a> implements the call to
 <a href="https://support.datacite.org/docs/mds-api-guide">DataCite</a>. This
 clients supports the proxy by the use of
 <a href="../../../../../org/restlet/ext/httpclient4/HttpDOIClientHelper.html" title="class in org.restlet.ext.httpclient4"><code>HttpDOIClientHelper</code></a> plugin. This plugin
 is registered by default when the method
 <a href="../../../../../fr/cnes/doi/client/BaseClient.html#getClient--"><code>BaseClient.getClient()</code></a> is used. The proxy parameters
 are automatically set from the config.properties by the use of
 <a href="../../../../../fr/cnes/doi/settings/ProxySettings.html" title="class in fr.cnes.doi.settings"><code>ProxySettings</code></a>


 <img src="../../../../../doc-files/mds.png" alt="MDS application">

 <h2>How to create a DOI</h2>
 Here are the different steps to create a DOI:
 <ul>
 <li>1. Create a project on the server by using the
 <a href="../../../../../fr/cnes/doi/application/AdminApplication.html" title="class in fr.cnes.doi.application"><code>AdminApplication</code></a> through the resource
 <a href="../../../../../fr/cnes/doi/resource/admin/SuffixProjectsResource.html#createProject-org.restlet.data.Form-"><code>SuffixProjectsResource.createProject(org.restlet.data.Form)</code></a>. The
 response at this resource is an identifier, which is a part of the DOI
 suffix. This suffix guarantees the uniqueness of the DOI within the
 institution at condition that the project defines an identifier for each
 data. This data identifier will be part of the DOI suffix. Thus, the new DOI
 suffix has the following syntax <b>projectIdentifier/dataIdentifier</b></li>
 <li>2 - Create the DOI metadata according to the
 <a href="../../../../../fr/cnes/doi/client/ClientMDS.html#SCHEMA_DATACITE">"https://schema.datacite.org/meta/kernel-4-1/metadata.xsd"</a> schema.</li>
 <li>3 - Upload the DOI metadata by using the
 <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html" title="class in fr.cnes.doi.application"><code>DoiMdsApplication</code></a> application through the
 <a href="../../../../../fr/cnes/doi/resource/mds/MetadatasResource.html" title="class in fr.cnes.doi.resource.mds"><code>MetadatasResource</code></a></li>
 <li>4 - Upload the landing page URL using
 <a href="../../../../../fr/cnes/doi/application/DoiMdsApplication.html" title="class in fr.cnes.doi.application"><code>DoiMdsApplication</code></a> application through the
 <a href="../../../../../fr/cnes/doi/resource/mds/DoisResource.html" title="class in fr.cnes.doi.resource.mds"><code>DoisResource</code></a></li>
 </ul>
 As below, an example of a code to create a DOI.
 <pre>
 <code>
      // 1 - Upload the metadata
      // -------------------

      // Prepare the request
      ClientResource client = new ClientResource("http://localhost:" + port + METADATA_SERVICE);
      // Set the login/pwd for basic authentication
      client.setChallengeResponse(
          new ChallengeResponse(ChallengeScheme.HTTP_BASIC, "malapert", "pwd")
      );
      // Set the project identifier (which is a part of the DOI) for authorisation
      reqAttribs = client.getRequestAttributes();
      headers = (Series) reqAttribs.get(RESTLET_HTTP_HEADERS);
      if (headers == null) {
          headers = new Series&lt;&gt;(Header.class);
          reqAttribs.put(RESTLET_HTTP_HEADERS, headers);
      }
      headers.add(UtilsHeader.SELECTED_ROLE_PARAMETER, "828606");
      // Request the metadata service
      try {
          Representation rep = client.post(
              new StringRepresentation(this.doiMetadata, MediaType.APPLICATION_XML)
          );
      } catch (ResourceException ex) {
      } finally {
          client.release();
      }

      // 2 - now we need to upload the landing page URL
      //------------------------------------------------

      // Create the first input parameter : DOI
      Form doiForm = new Form();
      doiForm.add(
          new Parameter(
              DoisResource.DOI_PARAMETER,
              "10.5072/828606/8c3e91ad45ca855b477126bc073ae44b"
          )
      );
      // Create the second input parameter : landing page
      doiForm.add(new Parameter(DoisResource.URL_PARAMETER, "http://www.cnes.fr"));

      // Prepare the query
      String port = DoiSettings.getInstance().getString(Consts.SERVER_HTTP_PORT);
      client = new ClientResource("http://localhost:" + port + DOIS_SERVICE);
      // Set the login/password
      client.setChallengeResponse(
          new ChallengeResponse(
              ChallengeScheme.HTTP_BASIC,
              "malapert",
              "pwd"
          )
      );
      // Define the role based on the project identifier
      final String RESTLET_HTTP_HEADERS = "org.restlet.http.headers";
      Map&lt;String, Object&gt; reqAttribs = client.getRequestAttributes();
      Series headers = (Series) reqAttribs.get(RESTLET_HTTP_HEADERS);
      if (headers == null) {
          headers = new Series&lt;&gt;(Header.class);
          reqAttribs.put(RESTLET_HTTP_HEADERS, headers);
      }
      headers.add(UtilsHeader.SELECTED_ROLE_PARAMETER, "828606");

      // Make the request
      try {
          Representation rep = client.post(doiForm);
      } catch (ResourceException ex) {
      } finally {
          client.release();
      }
 </code>
 </pre></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../fr/cnes/doi/server/package-summary.html"><code>Architecture definition</code></a></dd>
</dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../fr/cnes/doi/resource/citation/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../../fr/cnes/doi/security/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?fr/cnes/doi/resource/mds/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2017&#x2013;2020 <a href="https://cnes.fr">CNES</a>. All rights reserved.</small></p>
</body>
</html>
