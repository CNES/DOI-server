<!DOCTYPE html>
<html>
	<head>
		<title>Authentification</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Bootstrap -->
		<link href="css/bootstrap-min.css" rel="stylesheet">

		<style type="text/css">
		      body {
			padding-top: 40px;
			padding-bottom: 40px;
			background-color: #f5f5f5;
		      }

		      .form-signin {
			max-width: 300px;
			padding: 19px 29px 29px;
			margin: 0 auto 20px;
			background-color: #fff;
			border: 1px solid #e5e5e5;
			-webkit-border-radius: 5px;
			   -moz-border-radius: 5px;
				border-radius: 5px;
			-webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
			   -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
				box-shadow: 0 1px 2px rgba(0,0,0,.05);
		      }
		      .form-signin .form-signin-heading,
		      .form-signin .checkbox {
			margin-bottom: 10px;
		      }
		      .form-signin input[type="text"],
		      .form-signin input[type="password"] {
			font-size: 16px;
			height: auto;
			margin-bottom: 15px;
			padding: 7px 9px;
		      }
		</style>


	</head>
	<body>
		<div class="container">

			<form class="form-signin">  
				<h2 class="form-signin-heading" style="color:#005191">Connexion</h2>
				<input id="user" type="text" class="input-block-level" placeholder="Nom utilisateur">
				<input id="password" type="password" class="input-block-level" placeholder="Mot de passe">
				<button type="button" class="btn btn-large btn-primary" onclick="authentication()">Se connecter</button>
			</form>
				
			<hr>
			<div id="footer"></div>
		</div>
  	</body>
  	
		<script src="js/jquery-min.js"></script>
		<script src="js/bootstrap-min.js"></script>
		<script>
			var listUser;
			var users = [];
			var admins = [];
			var projets = [];

			function authentication(){
				var usrpwd = $("#user").val() + "." + $("#password").val();
				
				for (var i=0 ; i < listUser.length ; i++ ){
					var all = listUser[i].split(':');
					users.push(all[0]);
					admins.push(all[1]);
					projets.push(all[2]);
				}
				
				for ( var i=0 ; i < listUser.length ; i++ ){
					if ( usrpwd === users[i] ){ 
						sessionStorage.setItem("id", $("#user").val());
						sessionStorage.setItem("admin", admins[i]);
						sessionStorage.setItem("projets", projets[i]);
						
						if(projets[i] == "" && admins[i] == "admin"){
							window.location.href = "administration.html";  
						} else {
							window.location.href = "doiCreation.html"; 
						}
						
						return;
					} 
				}
				alert("Utilisateur ou mot de passe incorrect.");
			}

			$(document).ready(function(){
				$("#footer").load("footer.txt");

				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
						 listUser = this.responseText.split(";");
					}
				};
				xhttp.open("GET", "listUser.txt", true);
				xhttp.send();

			});
		</script>
</html>
