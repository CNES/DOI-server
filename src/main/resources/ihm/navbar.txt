<meta charset="utf-8"> <!-- this line is for the "confirm" popup! -->
<!-- Static navbar -->
<nav class="navbar navbar-default">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<div id="right" class="navbar-brand">User/Admin</div>
		</div>
		<div id="navbar" class="navbar-collapse collapse">
			<ul class="nav navbar-nav">
				<li><a href="doiCreation.html">Creation DOI</a></li>
				<li><a href="doiModification.html">Modification DOI</a></li>
				<li><a href="doiDeactivation.html">Desactivation DOI</a></li>
				<li><a href="citations.html">Citations</a></li>
				<li><a href="administration.html">Administration</a></li>
			</ul>
			<form class="navbar-form navbar-right">
				<label class="control-label" style="color:#FFFFFF">Projet courant :</label>
				<select id="selection" class="form-control"></select>
			</form>
		</div><!--/.nav-collapse -->
	</div><!--/.container-fluid -->
</nav>
<script>
	var projets = sessionStorage.getItem("projets").split(',');
	var selectedProjet = sessionStorage.getItem("projet");
	var right = sessionStorage.getItem("admin");
	var id = sessionStorage.getItem("id");
	
	var previousSelect;
	function atLoading(){
		$("#right").text(id + "/" + right);
		if(right != "admin"){
			$("[href='administration.html']").addClass("hide");
		}
		if(projets == ""){
			$("[href='doiCreation.html']").addClass("hide");
			$("[href='doiModification.html']").addClass("hide");
			$("[href='doiDeactivation.html']").addClass("hide");
			$("[href='citations.html']").addClass("hide");
		} else {
			for(var i = 0 ; i < projets.length ; i++){
				$("#selection").append("<option>" + projets[i] + "</option>");
			}
			if(selectedProjet != null){
				$("#selection").val(selectedProjet);
			}else{
				$("#selection").val(projets[0]);
				sessionStorage.setItem("projet", projets[0]);
			}
			previousSelect = $("#selection").val();
		}
	}
	atLoading();
	
	// keep the selected project in memorys
	$("#selection").change(function(){
		var select = $("#selection").val();
		if (confirm("Voulez-vous vraiment changer de projet ?" 
						+"\nToute action non sauvegard√©e sera perdu." )
				){
			sessionStorage.setItem("projet", select);
			location.reload();
		}else{
			$("#selection").val(previousSelect);
		}
		
	});
</script>