<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from org.apache.maven.plugins:maven-pmd-plugin:3.8:cpd at 2019-09-18
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190918" />
    <meta http-equiv="Content-Language" content="en" />
    <title>DOI-server &#x2013; CPD Results</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="./" id="bannerLeft"><h2>Digital Object Identifier Server</h2>
</a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="index.html" title="Home">Home</a><span class="divider">/</span></li>
    <li class="active ">CPD Results</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://github.com/CNES/DOI-server" class="externalLink" title="GitHub project">GitHub project</a></li>
      <li class="pull-right"><a href="https://github.com/CNES/DOI-server/releases" class="externalLink" title="Download">Download</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Main</li>
    <li><a href="index.html" title="Home"><span class="none"></span>Home</a></li>
    <li><a href="https://github.com/CNES/DOI-server" class="externalLink" title="GitHub project"><span class="none"></span>GitHub project</a></li>
      <li class="nav-header">ChangeLog</li>
    <li><a href="changelog.html" title="Change log"><span class="none"></span>Change log</a></li>
    <li><a href="file-activity.html" title="File activity"><span class="none"></span>File activity</a></li>
    <li><a href="dev-activity.html" title="Dev activity"><span class="none"></span>Dev activity</a></li>
      <li class="nav-header">Download</li>
    <li><a href="https://github.com/CNES/DOI-server/releases" class="externalLink" title="Download"><span class="none"></span>Download</a></li>
    <li><a href="https://github.com/CNES/DOI-server/blob/master/COPYING.LESSER" class="externalLink" title="License"><span class="none"></span>License</a></li>
      <li class="nav-header">Documentation</li>
    <li><a href="architecture.html" title="Architecture"><span class="none"></span>Architecture</a></li>
    <li><a href="usage.html" title="Usage"><span class="none"></span>Usage</a></li>
    <li><a href="configuration.html" title="Configuration"><span class="none"></span>Configuration</a></li>
    <li><a href="mds_api.html" title="MDS API"><span class="none"></span>MDS API</a></li>
    <li><a href="citation_api.html" title="Citation API"><span class="none"></span>Citation API</a></li>
    <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
      <li class="nav-header">Contribute</li>
    <li><a href="https://github.com/CNES/DOI-server/blob/master/CONTRIBUTING.md" class="externalLink" title="Contribute"><span class="none"></span>Contribute</a></li>
    <li><a href="https://github.com/CNES/DOI-server/issues" class="externalLink" title="Issues"><span class="none"></span>Issues</a></li>
    <li><a href="https://github.com/CNES/DOI-server" class="externalLink" title="Fork on GitHub"><span class="none"></span>Fork on GitHub</a></li>
      <li class="nav-header">Maven documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-down"></span>Project Reports</a>
    <ul class="nav nav-list">
    <li><a href="pdf/index.html" title="PDF"><span class="none"></span>PDF</a></li>
    <li><a href="xref/index.html" title="Source Xref"><span class="none"></span>Source Xref</a></li>
    <li><a href="xref-test/index.html" title="Test Source Xref"><span class="none"></span>Test Source Xref</a></li>
    <li><a href="dependency-updates-report.html" title="Dependency Updates Report"><span class="none"></span>Dependency Updates Report</a></li>
    <li><a href="plugin-updates-report.html" title="Plugin Updates Report"><span class="none"></span>Plugin Updates Report</a></li>
    <li><a href="property-updates-report.html" title="Property Updates Report"><span class="none"></span>Property Updates Report</a></li>
    <li><a href="checkstyle.html" title="Checkstyle"><span class="none"></span>Checkstyle</a></li>
    <li class="active"><a href="#"><span class="none"></span>CPD</a></li>
    <li><a href="pmd.html" title="PMD"><span class="none"></span>PMD</a></li>
    <li><a href="taglist.html" title="Tag List"><span class="none"></span>Tag List</a></li>
    <li><a href="findbugs.html" title="FindBugs"><span class="none"></span>FindBugs</a></li>
    <li><a href="cobertura/index.html" title="Cobertura Test Coverage"><span class="none"></span>Cobertura Test Coverage</a></li>
    <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
    <li><a href="testapidocs/index.html" title="Test Javadoc"><span class="none"></span>Test Javadoc</a></li>
    <li><a href="changelog.html" title="Change Log"><span class="none"></span>Change Log</a></li>
    <li><a href="file-activity.html" title="File Activity"><span class="none"></span>File Activity</a></li>
    <li><a href="dev-activity.html" title="Developer Activity"><span class="none"></span>Developer Activity</a></li>
    </ul>
</li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="https://cnes.fr" title="CNES" class="builtBy"><img class="builtBy"  alt="logo" src="https://cnes.fr/sites/default/files/drupal/201707/image/is_logo_cnes_logo_7.jpg"  border=""  width="320"  height="" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<h2><a name="CPD_Results"></a>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 5.6.1.</p></div>
<div class="section">
<h2><a name="Duplications"></a>Duplications</h2>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>fr/cnes/doi/plugin/impl/db/DefaultProjectSuffixImpl.java</td>
<td><a href="./xref/fr/cnes/doi/plugin/impl/db/DefaultProjectSuffixImpl.html#L104">104</a></td></tr>
<tr class="a">
<td>fr/cnes/doi/plugin/impl/db/DefaultTokenImpl.java</td>
<td><a href="./xref/fr/cnes/doi/plugin/impl/db/DefaultTokenImpl.html#L102">102</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    @Override
    public void setConfiguration(final Object configuration) {
        this.conf = (Map&lt;String, String&gt;) configuration;
        final String dbUrl = this.conf.get(DB_URL);
        final String dbUser = this.conf.get(DB_USER);
        final String dbPwd = this.conf.get(DB_PWD);
        if (this.conf.containsKey(DB_MIN_IDLE_CONNECTIONS)) {
            this.options.put(DB_MIN_IDLE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MIN_IDLE_CONNECTIONS)));
        }
        if (this.conf.containsKey(DB_MAX_IDLE_CONNECTIONS)) {
            this.options.put(DB_MAX_IDLE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MAX_IDLE_CONNECTIONS)));
        }
        if (this.conf.containsKey(DB_MAX_ACTIVE_CONNECTIONS)) {
            this.options.put(DB_MAX_ACTIVE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MAX_ACTIVE_CONNECTIONS)));
        }
        LOG.info(&quot;[CONF] Plugin database URL : {}&quot;, dbUrl);
        LOG.info(&quot;[CONF] Plugin database user : {}&quot;, dbUser);
        LOG.info(&quot;[CONF] Plugin database password : {}&quot;, Utils.transformPasswordToStars(dbPwd));
        LOG.info(&quot;[CONF] Plugin options : {}&quot;, this.options);

        this.configured = true;
    }

    @Override
    public void initConnection() throws DoiRuntimeException {
        DatabaseSingleton.getInstance().init(
                this.conf.get(DB_URL), this.conf.get(DB_USER), this.conf.get(DB_PWD), this.options);
        this.das = DatabaseSingleton.getInstance().getDatabaseAccess();
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public synchronized boolean addProjectSuffix(final int projectID, final String projectName) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>fr/cnes/doi/plugin/impl/db/DefaultTokenImpl.java</td>
<td><a href="./xref/fr/cnes/doi/plugin/impl/db/DefaultTokenImpl.html#L77">77</a></td></tr>
<tr class="a">
<td>fr/cnes/doi/plugin/impl/db/DefaultUserRoleImpl.java</td>
<td><a href="./xref/fr/cnes/doi/plugin/impl/db/DefaultUserRoleImpl.html#L90">90</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    private final String NAME = this.getClass().getName();

    /**
     * Database access.
     */
    private DOIDbDataAccessService das;

    /**
     * Configuration file.
     */
    private Map&lt;String, String&gt; conf;

    /**
     * Status of the plugin configuration.
     */
    private boolean configured = false;

    /**
     * Options for JDBC.
     */
    private final Map&lt;String, Integer&gt; options = new ConcurrentHashMap&lt;&gt;();

    /**
     * {@inheritDoc }
     */
    @Override
    public void setConfiguration(final Object configuration) {
        this.conf = (Map&lt;String, String&gt;) configuration;
        final String dbUrl = this.conf.get(DB_URL);
        final String dbUser = this.conf.get(DB_USER);
        final String dbPwd = this.conf.get(DB_PWD);
        if (this.conf.containsKey(DB_MIN_IDLE_CONNECTIONS)) {
            this.options.put(DB_MIN_IDLE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MIN_IDLE_CONNECTIONS)));
        }
        if (this.conf.containsKey(DB_MAX_IDLE_CONNECTIONS)) {
            this.options.put(DB_MAX_IDLE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MAX_IDLE_CONNECTIONS)));
        }
        if (this.conf.containsKey(DB_MAX_ACTIVE_CONNECTIONS)) {
            this.options.put(DB_MAX_ACTIVE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MAX_ACTIVE_CONNECTIONS)));
        }
        LOG.info(&quot;[CONF] Plugin database URL : {}&quot;, dbUrl);
        LOG.info(&quot;[CONF] Plugin database user : {}&quot;, dbUser);
        LOG.info(&quot;[CONF] Plugin database password : {}&quot;, Utils.transformPasswordToStars(dbPwd));
        LOG.info(&quot;[CONF] Plugin options : {}&quot;, this.options);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>fr/cnes/doi/plugin/impl/db/DefaultProjectSuffixImpl.java</td>
<td><a href="./xref/fr/cnes/doi/plugin/impl/db/DefaultProjectSuffixImpl.html#L104">104</a></td></tr>
<tr class="a">
<td>fr/cnes/doi/plugin/impl/db/DefaultUserRoleImpl.java</td>
<td><a href="./xref/fr/cnes/doi/plugin/impl/db/DefaultUserRoleImpl.html#L115">115</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    @Override
    public void setConfiguration(final Object configuration) {
        this.conf = (Map&lt;String, String&gt;) configuration;
        final String dbUrl = this.conf.get(DB_URL);
        final String dbUser = this.conf.get(DB_USER);
        final String dbPwd = this.conf.get(DB_PWD);
        if (this.conf.containsKey(DB_MIN_IDLE_CONNECTIONS)) {
            this.options.put(DB_MIN_IDLE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MIN_IDLE_CONNECTIONS)));
        }
        if (this.conf.containsKey(DB_MAX_IDLE_CONNECTIONS)) {
            this.options.put(DB_MAX_IDLE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MAX_IDLE_CONNECTIONS)));
        }
        if (this.conf.containsKey(DB_MAX_ACTIVE_CONNECTIONS)) {
            this.options.put(DB_MAX_ACTIVE_CONNECTIONS,
                    Integer.valueOf(this.conf.get(DB_MAX_ACTIVE_CONNECTIONS)));
        }
        LOG.info(&quot;[CONF] Plugin database URL : {}&quot;, dbUrl);
        LOG.info(&quot;[CONF] Plugin database user : {}&quot;, dbUser);
        LOG.info(&quot;[CONF] Plugin database password : {}&quot;, Utils.transformPasswordToStars(dbPwd));
        LOG.info(&quot;[CONF] Plugin options : {}&quot;, this.options);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>fr/cnes/doi/resource/admin/SuffixProjectsDoisResource.java</td>
<td><a href="./xref/fr/cnes/doi/resource/admin/SuffixProjectsDoisResource.html#L104">104</a></td></tr>
<tr class="a">
<td>fr/cnes/doi/resource/admin/SuffixProjectsResource.java</td>
<td><a href="./xref/fr/cnes/doi/resource/admin/SuffixProjectsResource.html#L164">164</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        return LOG.traceExit(response);
    }

    /**
     * projects representation
     *
     * @return Wadl representation for projects
     */
    @Requirement(reqId = Requirement.DOI_DOC_010, reqName = Requirement.DOI_DOC_010_NAME)
    private RepresentationInfo projectsRepresentation() {
        final RepresentationInfo repInfo = new RepresentationInfo();
        repInfo.setMediaType(MediaType.APPLICATION_XML);
        final DocumentationInfo docInfo = new DocumentationInfo();
        docInfo.setTitle(&quot;Projects Representation&quot;);
        docInfo.setTextContent(&quot;The representation contains informations about all projects.&quot;);
        repInfo.setDocumentation(docInfo);
        return repInfo;
    }

    //TODO describres get method
    /**
     * Describes a GET method.
     *
     * @param info method information
     */
    @Requirement(reqId = Requirement.DOI_DOC_010, reqName = Requirement.DOI_DOC_010_NAME)
    @Override
    protected void describeGet(final MethodInfo info) {
        info.setName(Method.GET);
        info.setDocumentation(&quot;Get information about the created projects&quot;);
        addResponseDocToMethod(info, createResponseDoc(
                Status.SUCCESS_OK,
                &quot;Operation successful&quot;,
                projectsRepresentation()
        ));
    }</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>fr/cnes/doi/application/AdminApplication.java</td>
<td><a href="./xref/fr/cnes/doi/application/AdminApplication.html#L345">345</a></td></tr>
<tr class="a">
<td>fr/cnes/doi/application/DoiMdsApplication.java</td>
<td><a href="./xref/fr/cnes/doi/application/DoiMdsApplication.html#L202">202</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }

    /**
     * Creates a router for the AdminApplication. This router routes :
     * &lt;ul&gt;
     * &lt;li&gt;the web resources for the website with no authentication&lt;/li&gt;
     * &lt;li&gt;the REST resources for the system administration with
     * authentication/authorization&lt;/li&gt;
     * &lt;/ul&gt;
     * The web resources are attached by default to the AdminApplication where
     * as the REST resources for the system administration are attached with the
     * {@link AdminApplication#ADMIN_URI}
     *
     * @see AdminApplication#createWebSiteRouter() the router that contains the
     * the web resources
     * @see AdminApplication#createAdminRouter() the router that contains the
     * REST resources
     * @see AdminApplication#createAuthenticator() the authentication mechanism
     * @see AdminApplication#createRoleAuthorizer() the authorization mechanism
     * @return Router
     */
    @Override
    public Restlet createInboundRoot() {
        LOG.traceEntry();
        
        final Filter logContext = new Filter() {
            @Override
            protected int beforeHandle(Request request, Response response) {
                final ClientInfo clientInfo = request.getClientInfo();
                final String ipAddress = request.getHeaders().getFirstValue(
                        Consts.PROXIFIED_IP, clientInfo.getUpstreamAddress()
                );
                ThreadContext.put(Consts.LOG_IP_ADDRESS, ipAddress);
                return Filter.CONTINUE;
            }
        }; 
        
        // Defines the strategy of authentication (authentication is not required)
        //   - authentication with login/pwd
        final ChallengeAuthenticator challAuth = createAuthenticatorLoginBased();
        challAuth.setOptional(true);

        //   - authentication with token
        final ChallengeAuthenticator challTokenAuth = createTokenAuthenticator();
        challTokenAuth.setOptional(false);</pre></div></td></tr></table></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2017&#x2013;2019
<a href="https://cnes.fr">CNES</a>.
All rights reserved.        <li id="publishDate" class="pull-right">Last Published: 2019-09-18</li>
          <li id="projectVersion" class="pull-right"><span class="divider">|</span>Version: 1.0.2</li>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
