<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/markdown/usage.md at 2019-04-15
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190415" />
    <meta http-equiv="Content-Language" content="en" />
    <title>DOI-server &#x2013; Usage</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="./" id="bannerLeft"><h2>Digital Object Identifier Server</h2>
</a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="index.html" title="Home">Home</a><span class="divider">/</span></li>
    <li class="active ">Usage</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://github.com/CNES/DOI-server" class="externalLink" title="GitHub project">GitHub project</a></li>
      <li class="pull-right"><a href="https://github.com/CNES/DOI-server/releases" class="externalLink" title="Download">Download</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Main</li>
    <li><a href="index.html" title="Home"><span class="none"></span>Home</a></li>
    <li><a href="https://github.com/CNES/DOI-server" class="externalLink" title="GitHub project"><span class="none"></span>GitHub project</a></li>
      <li class="nav-header">ChangeLog</li>
    <li><a href="changelog.html" title="Change log"><span class="none"></span>Change log</a></li>
    <li><a href="file-activity.html" title="File activity"><span class="none"></span>File activity</a></li>
    <li><a href="dev-activity.html" title="Dev activity"><span class="none"></span>Dev activity</a></li>
      <li class="nav-header">Download</li>
    <li><a href="https://github.com/CNES/DOI-server/releases" class="externalLink" title="Download"><span class="none"></span>Download</a></li>
    <li><a href="https://github.com/CNES/DOI-server/blob/master/COPYING.LESSER" class="externalLink" title="License"><span class="none"></span>License</a></li>
      <li class="nav-header">Documentation</li>
    <li><a href="architecture.html" title="Architecture"><span class="none"></span>Architecture</a></li>
    <li class="active"><a href="#"><span class="none"></span>Usage</a></li>
    <li><a href="configuration.html" title="Configuration"><span class="none"></span>Configuration</a></li>
    <li><a href="mds_api.html" title="MDS API"><span class="none"></span>MDS API</a></li>
    <li><a href="citation_api.html" title="Citation API"><span class="none"></span>Citation API</a></li>
    <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
      <li class="nav-header">Contribute</li>
    <li><a href="https://github.com/CNES/DOI-server/blob/master/CONTRIBUTING.md" class="externalLink" title="Contribute"><span class="none"></span>Contribute</a></li>
    <li><a href="https://github.com/CNES/DOI-server/issues" class="externalLink" title="Issues"><span class="none"></span>Issues</a></li>
    <li><a href="https://github.com/CNES/DOI-server" class="externalLink" title="Fork on GitHub"><span class="none"></span>Fork on GitHub</a></li>
      <li class="nav-header">Maven documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="https://cnes.fr" title="CNES" class="builtBy"><img class="builtBy"  alt="logo" src="https://cnes.fr/sites/default/files/drupal/201707/image/is_logo_cnes_logo_7.jpg"  border=""  width="320"  height="" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Usage</h1>
<div class="section">
<h2><a name="Table_of_contents"></a>Table of contents</h2>
<ol style="list-style-type: decimal">

<li><a href="#getting_help">Getting Help</a></li>
<li><a href="#getting_version">Getting Version</a></li>
<li><a href="#creatin_conf_file">Creating the configuration file</a></li>
<li><a href="#encrypting_password">Encrypting a password</a>
<ol style="list-style-type: decimal">

<li><a href="#encrypting_password_default_key">Encrypting the password with the default key</a></li>
<li><a href="#encrypting_password_custom_key">Encrypting the password with a custom key</a></li>
</ol>
</li>
<li><a href="#decrypting_password">Decrypting the password</a>
<ol style="list-style-type: decimal">

<li><a href="#decrypting_password_default_key">Decrypting the password with the default key</a></li>
<li><a href="#decrypting_password_custom_key">Decrypting the password with a custom key</a></li>
</ol>
</li>
<li><a href="#configuration_file">Configuration file</a></li>
<li><a href="#log_configuration_file">Log configuration file</a></li>
<li><a href="#starting_server">Starting the server</a>
<ol style="list-style-type: decimal">

<li><a href="#starting_server_default_key">Starting the server with the default key to decrypt the passwords</a></li>
<li><a href="#starting_server_custom_key">Starting the server with a custom key to decrypt the passwords</a></li>
</ol>
</li>
<li><a href="#stopping_server">Stopping the server</a></li>
</ol></div>
<div class="section">
<h2><a name="a1._Getting_Help"></a>1. Getting Help <a name="getting_help"></a></h2>

<div>
<div>
<pre class="source">malapert@heulet-HP-ZBook-15-G4:~/DOI$ java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar -h

------------ Help for DOI Server -----------

Usage: java -jar DOI-server.jar [--secret &lt;key&gt;] [OPTIONS] [-s]


with :
  --secret &lt;key&gt;               : The 16 bits secret key to crypt/decrypt
  --key-sign-secret &lt;key&gt;      : The key to sign the token
                                 If not provided, a default one is used
  -s|--start                   : Starts the server
  -t|--stop                    : Stops the server
  -l|--status                  : Status of the server
with OPTIONS:
  -h|--help                    : This output
  -k|--key-sign                : Creates a key to sign JWT token
  -c &lt;string&gt;                  : Crypts a string in the standard output
  -e &lt;string&gt;                  : Decrypts a string in the standard output
  -d                           : Displays the configuration file
  -f &lt;path&gt;                    : Loads the configuation file
  -y|--cryptProperties &lt;path&gt;  : crypts the properties file on the output standard
  -z|--decryptProperties &lt;path&gt;: Decrypts the properties on the output standard
  -v|--version                 : DOI server version

</pre></div></div>
</div>
<div class="section">
<h2><a name="a2._Getting_version"></a>2. Getting version <a name="getting_version"></a></h2>

<div>
<div>
<pre class="source">malapert@heulet-HP-ZBook-15-G4:~/DOI$ java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar -v
DOI-server (Copyright 2017-2019 CNES) - Version:1.0.0
</pre></div></div>
</div>
<div class="section">
<h2><a name="a3._Creating_the_configuration_file"></a>3. Creating the configuration file <a name="creating_conf_file"></a></h2>

<div>
<div>
<pre class="source">java -Dlog4j.configurationFile=server/target/log4j2.xml -jar server/target/DOI-server-1.0.0.jar -d &gt; doi.conf
</pre></div></div>
</div>
<div class="section">
<h2><a name="a4._Encrypting_a_password"></a>4. Encrypting a password <a name="encrypting_password"></a></h2>
<div class="section">
<h3><a name="a4.1_Encrypting_the_password_with_the_default_key"></a>4.1 Encrypting the password with the default key <a name="encrypting_password_default_key"></a></h3>

<div>
<div>
<pre class="source">malapert@heulet-HP-ZBook-15-G4:~/DOI$ java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar -c test
7nAsnRnwzGL+v/SsnQ4rXg==
</pre></div></div>
</div>
<div class="section">
<h3><a name="a4.2_Encrypting_the_password_with_a_custom_key"></a>4.2 Encrypting the password with a custom key <a name="encrypting_password_custom_key"></a></h3>

<div>
<div>
<pre class="source">malapert@heulet-HP-ZBook-15-G4:~/DOI$ java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar --secret wxcvbnqsdfg12345 -c test 
giXEr40f5832YFYgAiWMRA==
</pre></div></div>
</div></div>
<div class="section">
<h2><a name="a5._Decrypting_a_password"></a>5. Decrypting a password <a name="decrypting_password"></a></h2>
<div class="section">
<h3><a name="a5.1_Decrypting_the_password_with_the_default_key"></a>5.1 Decrypting the password with the default key <a name="decrypting_password_default_key"></a></h3>

<div>
<div>
<pre class="source">malapert@heulet-HP-ZBook-15-G4:~/DOI$ java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar -e 7nAsnRnwzGL+v/SsnQ4rXg==
test
</pre></div></div>
</div>
<div class="section">
<h3><a name="a5.2_Decrypting_the_password_with_a_custom_key"></a>5.2 Decrypting the password with a custom key <a name="decrypting_password_custom_key"></a></h3>

<div>
<div>
<pre class="source">malapert@heulet-HP-ZBook-15-G4:~/DOI$ java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar --secret wxcvbnqsdfg12345 -e giXEr40f5832YFYgAiWMRA==
test
</pre></div></div>
</div></div>
<div class="section">
<h2><a name="a6._Configuration_file"></a>6. Configuration file <a name="configuration_file"></a></h2>
<p>See <a href="./configuration.html">configuration</a></p></div>
<div class="section">
<h2><a name="a7._Log_configuration_file"></a>7. Log configuration file <a name="log_configuration_file"></a></h2>

<div>
<div>
<pre class="source">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Configuration status=&quot;INFO&quot;&gt;
    &lt;properties&gt;
            &lt;property name=&quot;servicename&quot;&gt;doiserver&lt;/property&gt;
            &lt;property name=&quot;patternPerfo&quot;&gt;%-5p | %d{yyyy-MM-dd HH:mm:ss} | [%t] %C{2} (%F:%L) - %m%n&lt;/property&gt;
            &lt;property name=&quot;patternFile&quot;&gt;%-5level %d{yyyy-MM-dd HH:mm:ss} %C{2} (%F:%L) - %m%n&lt;/property&gt; 
            &lt;property name=&quot;patternApi&quot;&gt;[%-5p - %t] %d %c - %m%n&lt;/property&gt;     
            &lt;property name=&quot;patternSecurity&quot;&gt;%d{yyyy-MM-dd HH:mm:ss} %C{2} (%F:%L) - %m%n&lt;/property&gt;                                                                             
    &lt;/properties&gt;
    
    &lt;Appenders&gt;
        &lt;Syslog name=&quot;syslog&quot; host=&quot;localhost&quot; port=&quot;514&quot; protocol=&quot;UDP&quot; appName=&quot;${servicename}&quot;&gt;
        &lt;/Syslog&gt;        
        &lt;RollingFile name=&quot;RollingFilePerfo&quot; fileName=&quot;logs/doi-perfo.log&quot;
                         filePattern=&quot;logs/$${date:yyyy-MM}/perfo-%d{yyyy-MM-dd}-%i.log.gz&quot;&gt;
                &lt;PatternLayout&gt;
                        &lt;pattern&gt;${patternPerfo}&lt;/pattern&gt;
                &lt;/PatternLayout&gt;
                &lt;Policies&gt;
                        &lt;SizeBasedTriggeringPolicy size=&quot;100 MB&quot;/&gt; &lt;!-- Or every 100 MB --&gt;
                &lt;/Policies&gt;
        &lt;/RollingFile&gt;    
        &lt;RollingFile name=&quot;RollingFileFile&quot; fileName=&quot;logs/doi-file.log&quot;
                         filePattern=&quot;logs/$${date:yyyy-MM}/file-%d{yyyy-MM-dd}-%i.log.gz&quot;&gt;
                &lt;PatternLayout&gt;
                        &lt;pattern&gt;${patternFile}&lt;/pattern&gt;
                &lt;/PatternLayout&gt;
                &lt;Policies&gt;
                        &lt;SizeBasedTriggeringPolicy size=&quot;100 MB&quot;/&gt; &lt;!-- Or every 100 MB --&gt;
                &lt;/Policies&gt;
        &lt;/RollingFile&gt;      
        &lt;RollingFile name=&quot;RollingFileApi&quot; fileName=&quot;logs/doi-api.log&quot;
                         filePattern=&quot;logs/$${date:yyyy-MM}/api-%d{yyyy-MM-dd}-%i.log.gz&quot;&gt;
                &lt;PatternLayout&gt;
                        &lt;pattern&gt;${patternApi}&lt;/pattern&gt;
                &lt;/PatternLayout&gt;
                &lt;Policies&gt;
                        &lt;SizeBasedTriggeringPolicy size=&quot;100 MB&quot;/&gt; &lt;!-- Or every 100 MB --&gt;
                &lt;/Policies&gt;
        &lt;/RollingFile&gt;  
        &lt;RollingFile name=&quot;RollingFileSecurity&quot; fileName=&quot;logs/doi-security.log&quot;
                         filePattern=&quot;logs/$${date:yyyy-MM}/security-%d{yyyy-MM-dd}-%i.log.gz&quot;&gt;
                &lt;PatternLayout&gt;
                        &lt;pattern&gt;${patternSecurity}&lt;/pattern&gt;
                &lt;/PatternLayout&gt;
                &lt;Policies&gt;
                        &lt;SizeBasedTriggeringPolicy size=&quot;100 MB&quot;/&gt; &lt;!-- Or every 100 MB --&gt;
                &lt;/Policies&gt;
        &lt;/RollingFile&gt;                    
        &lt;Console name=&quot;CONSOLE&quot; target=&quot;SYSTEM_OUT&quot;&gt;
            &lt;PatternLayout pattern=&quot;%highlight{%d [%t] %-5level}: %msg%n%throwable&quot;/&gt;&lt;!--%highlight{%d [%t] %-5level}: %msg%n%throwable--&gt;
        &lt;/Console&gt;
        &lt;Console name=&quot;SHELL&quot; target=&quot;SYSTEM_OUT&quot;&gt;
            &lt;PatternLayout pattern=&quot;%msg%n&quot;/&gt;
        &lt;/Console&gt;        
    &lt;/Appenders&gt;

    &lt;Loggers&gt;
        &lt;Logger name=&quot;fr.cnes.doi.logging.security&quot; level=&quot;INFO&quot;&gt;
            &lt;AppenderRef ref=&quot;RollingFileSecurity&quot;/&gt;
            &lt;appender-ref ref=&quot;syslog&quot;/&gt;
        &lt;/Logger&gt;
        &lt;Logger name=&quot;fr.cnes.doi.logging.app&quot; level=&quot;INFO&quot;&gt;
            &lt;AppenderRef ref=&quot;RollingFilePerfo&quot;/&gt;                        
        &lt;/Logger&gt;        
        &lt;Logger name=&quot;fr.cnes.doi.logging.api&quot; level=&quot;INFO&quot;&gt;
            &lt;AppenderRef ref=&quot;RollingFileApi&quot;/&gt;
            &lt;appender-ref ref=&quot;syslog&quot;/&gt;                        
        &lt;/Logger&gt;
        &lt;Logger name=&quot;fr.cnes.doi.application&quot; level=&quot;INFO&quot;&gt;
            &lt;AppenderRef ref=&quot;RollingFileFile&quot;/&gt;            
        &lt;/Logger&gt;      
        &lt;Logger name=&quot;fr.cnes.doi.logging.shell&quot; level=&quot;INFO&quot;&gt;
             &lt;AppenderRef ref=&quot;SHELL&quot;/&gt;
        &lt;/Logger&gt;          
        &lt;Logger name=&quot;fr.cnes.doi.server&quot; level=&quot;INFO&quot;&gt;
             &lt;AppenderRef ref=&quot;FILE&quot;/&gt;
        &lt;/Logger&gt;  
                          
        &lt;Root level=&quot;INFO&quot;&gt;
            &lt;AppenderRef ref=&quot;FILE&quot;/&gt;            
        &lt;/Root&gt;
    &lt;/Loggers&gt;

&lt;/Configuration&gt;
</pre></div></div>
</div>
<div class="section">
<h2><a name="a8._Starting_the_server"></a>8. Starting the server <a name="starting_server"></a></h2>
<div class="section">
<h3><a name="a8.1_Starting_the_server_with_the_default_key_to_decrypt_the_passwords"></a>8.1 Starting the server with the default key to decrypt the passwords <a name="starting_server_default_key"></a></h3>

<div>
<div>
<pre class="source">java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar -f config.properties --start
</pre></div></div>
</div>
<div class="section">
<h3><a name="a8.2_Starting_the_server_with_a_custom_key_to_decrypt_the_passwords"></a>8.2 Starting the server with a custom key to decrypt the passwords <a name="starting_server_custom_key"></a></h3>

<div>
<div>
<pre class="source">java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar --secret wxcvbnqsdfg12345 -f config.properties --start
</pre></div></div>
</div></div>
<div class="section">
<h2><a name="a9._Stopping_the_server"></a>9. Stopping the server <a name="stopping_server"></a></h2>

<div>
<div>
<pre class="source">java -Dlog4j.configurationFile=./log4j2.xml -jar DOI-server.jar -f config.properties --stop
</pre></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2017&#x2013;2019
<a href="https://cnes.fr">CNES</a>.
All rights reserved.        <li id="publishDate" class="pull-right">Last Published: 2019-04-15</li>
          <li id="projectVersion" class="pull-right"><span class="divider">|</span>Version: 1.0.0</li>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
