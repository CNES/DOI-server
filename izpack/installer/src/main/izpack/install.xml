<izpack:installation version="5.0"
                     xmlns:izpack="http://izpack.org/schema/installation"
                     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                     xsi:schemaLocation="http://izpack.org/schema/installation http://izpack.org/schema/5.0/izpack-installation-5.0.xsd">

    <jar src="custom/izpack-panels.jar" />
    <jar src="custom/postgresql.jar"/>		     
    <info>
        <appname>DOI</appname>
        <appversion>1.0.0</appversion>
        <authors>
            <author email="jean-christophe.malapert@cnes.fr" name="Jean-Christophe Malapert (CNES)" />
            <author email="julien.perrin@atos.net" name="Julien Perrin (ATOS)" />
        </authors>
        <uninstaller name="Uninstaller.jar" write="yes" />
        <javaversion>1.8</javaversion>
        <requiresjdk>no</requiresjdk>
        <writeinstallationinformation>yes</writeinstallationinformation>
        <summarylogfilepath>$INSTALL_PATH/installLog</summarylogfilepath>
    </info>
    
    <listeners>
        <listener classname="fr.cnes.doi.izpack.actions.InstallDatabaseAction"  stage="install"/>
    </listeners>    
 
    <guiprefs width="900" height="700" resizable="yes">
        <modifier key="useHeadingPanel" value="yes" />
        <modifier key="headingImageOnLeft" value="yes" />
        <modifier key="headingLineCount" value="1" />
        <modifier key="headingFontSize" value="1.5" />
        <modifier key="headingBackgroundColor" value="0x00ffffff" />
        <modifier key="headingPanelCounter" value="text" />
        <modifier key="headingPanelCounterPos" value="inHeading" />
        <modifier key="langDisplayType" value="native" />
    </guiprefs> 
    
    <locale>
        <langpack iso3="eng" />
        <langpack iso3="fra" />
    </locale>
 
    <resources>
        <res id="LicencePanel.licence_eng" parse="yes" src="../../../../COPYING.LESSER" />
        <res id="LicencePanel.licence_fra" parse="yes" src="../../../../COPYING.LESSER" />        
        <res id="userInputSpec.xml" src="custom/user_input_spec.xml" parse="yes" type="xml"/>
        <res id="Heading.image" src="../../src/main/izpack/res/Cnes-logo.png" />        
    </resources>     

    <dynamicvariables>
        <variable name="project.db.url"
                  value="jdbc:postgresql://${project.db.hostname}:${project.db.port}/${project.db.name}?currentSchema=project.db.schema"
        />      
    </dynamicvariables>
    <conditions>
        <condition type="packselection" id="myDatabaseIsSelected">
            <name>Database</name>
        </condition>
        <condition type="packselection" id="myConfigurationIsSelected">
            <name>Configuration</name>
        </condition>         
        <condition type="variable" id="condition.proxy.basic">
            <name>project.proxy.type</name>
            <value>PROXY_BASIC</value>
        </condition>          
    </conditions>
 
    <panels>
        <panel classname="CheckedHelloPanel" />
        <panel classname="LicencePanel" />        
        <panel classname="TargetPanel"/>         
        <panel classname="TreePacksPanel"/>            

        <panel classname="UserInputPanel" id="datacitepanel" condition="myConfigurationIsSelected"/>
        <panel classname="UserInputPanel" id="databasepanel" condition="myConfigurationIsSelected">
            <validator classname="fr.cnes.doi.izpack.validator.JDBCConnectionValidator" />
        </panel>    
        <panel classname="UserInputPanel" id="tokenpanel" condition="myConfigurationIsSelected"/>   
        <panel classname="UserInputPanel" id="ldappanel" condition="myConfigurationIsSelected"/> 
        <panel classname="UserInputPanel" id="proxypanel" condition="myConfigurationIsSelected"/>
        <panel classname="UserInputPanel" id="smtppanel" condition="myConfigurationIsSelected"/>                             
        <panel classname="UserInputPanel" id="httppanel" condition="myConfigurationIsSelected"/>
        <panel classname="UserInputPanel" id="httpspanel" condition="myConfigurationIsSelected"/>       
           
        
        <panel classname="SummaryPanel" />
        <panel classname="InstallPanel"/>
        <panel classname="FinishPanel"/>
    </panels>
 
    <packs>
        <pack name="Server" preselected="yes" required="no">
            <description>This package contains the core of the server</description>
        </pack>
        <pack name="DOI" preselected="yes" required="yes" parent="Server">
            <description>This package installs the core of the server</description>
            <file src="custom/DOI.jar" targetdir="$INSTALL_PATH" unpack="false" /> 
            <file override="true" src="config/config.properties" targetdir="$INSTALL_PATH/" />   
            <parsable targetfile="$INSTALL_PATH/config.properties"/>
        </pack>     
        <pack name="Configuration" preselected="yes" required="no" parent="Server">
            <description>This package configures the DOI server</description>            
        </pack> 
        <pack name="ConfigFile" preselected="yes" required="no" parent="Configuration">
            <description>This package installs the DOI server configuration file</description>
            <file override="true" src="config/config.properties" targetdir="$INSTALL_PATH/" />   
            <parsable targetfile="$INSTALL_PATH/config.properties"/>
        </pack> 
        <pack name="Database" preselected="yes" required="no" parent="Configuration">
            <description>This package install the DOI server database</description>
        </pack> 
        <!--
        <pack name="Documentation" preselected="yes" required="no" parent="Server">
            <description>This package contains the DOI server documentation</description>
        </pack>         
        <pack name="Clients" preselected="no" required="no">
            <description>This package installs the clients to query the DOI server</description>
        </pack>  
        <pack name="PyDoiApiClient" preselected="no" required="no" parent="Clients">
            <description>This package installs the python client</description>
        </pack>    
        <pack name="JavaDoiApiClient" preselected="no" required="no" parent="Clients">
            <description>This package installs the JAVA client</description>
        </pack> 
        -->    
        
    </packs>        
 
</izpack:installation>
