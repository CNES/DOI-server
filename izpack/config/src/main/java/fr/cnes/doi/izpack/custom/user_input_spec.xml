<izpack:userinput version="5.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:izpack="http://izpack.org/schema/userinput" xsi:schemaLocation="http://izpack.org/schema/userinput http://izpack.org/schema/5.0/izpack-userinput-5.0.xsd">

    <!-- SMTP panel -->
    <panel id="smtppanel">
        <field type="title" size="2" txt="SMTP Settings" id="input.smtppanel.title"/>  
        <field type="space" />
        <field type="rule" variable="project.server.contact_admin">
            <spec size="20" txt="Email Address" id="input.email_address"
                      layout="O:19:U @ O:10:U . O:4:U" />
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="input.stmp.email.validator.1" txt="identifier is a required field" />
            <validator class="com.izforge.izpack.panels.userinput.validator.RegularExpressionValidator" txt="Invalid email address!" id="input.stmp.email.validator.2">
                <param name="pattern" value="[a-zA-Z0-9._-]{3,}@[a-zA-Z0-9._-]+([.][a-zA-Z0-9_-]+)*[.][a-zA-Z0-9._-]{2,4}" />
            </validator>
        </field>
        <field type="text" variable="project.mail.server">
            <spec txt="server:" id="input.smtp.server" size="25" set=""/>
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="input.stmp.server.validator" txt="server is a required field" />
        </field>        
        <field type="radio" variable="project.mail.tls">
            <description txt="Use TLS" id="input.smtp.tls.radio"/>
            <spec>
                <choice txt="true" id="input.smtp.tls.radio.1" value="true" />
                <choice txt="false" id="input.smtp.tls.radio.2" value="false" set="true"/>
            </spec>
        </field>        
        <field type="text" variable="project.mail.identifier">
            <spec txt="Login:" id="input.proxypanel.login" size="20" set="">                               
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.mail.identifier.plain">
                    <configuration>
                        <encryptionKey>16BYTESSECRETKEY</encryptionKey>
                        <algorithm>AES</algorithm>
                    </configuration>
                </processor>                              
            </spec>
        </field>                     
        <field type="password" variable="project.mail.secret">
            <spec>
                <pwd txt="Password:" size="15" set="" id="input.smtp.secret.password" />
                <pwd txt="Retype Password:" size="15" set="" id="input.smtp.secret.retypepassword" />                 
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.mail.secret.plain"/>
            </spec>
            <validator class="com.izforge.izpack.panels.userinput.validator.PasswordEqualityValidator" txt="Both keystore passwords must match." id="catalog.database.password.validator" />           
        </field>        
    </panel>

    <!-- HTTP/HTTPS panel -->
    <panel id="httppanel">
        <field type="title" size="2" txt="HTTP/HTTPS server Settings" id="input.httppanel.title"/> 
        <field type="radio" variable="project.server.http.type">
            <description txt="Select the server you want to configure" id="description.radio"/>
            <spec txt="Type: " id="input.smtp.server" size="25" set="">
                <choice txt="HTTP" id="input.smtp.tls.radio.1" value="HTTP"/>
                <choice txt="HTTPS" id="input.smtp.tls.radio.2" value="HTTPS" set="true"/>
            </spec>                
        </field>        
        <field type="text" variable="project.server.http.port" conditionid="condition.http">
            <spec txt="Http Port:" id="input.httppanel.port" size="6" set=""/>
        </field>
        <field type="text" variable="project.server.https.port" conditionid="condition.https">
            <spec txt="Https Port:" id="input.httpspanel.port" size="6" set=""/>
        </field>        
    </panel>

    <!-- Proxy panel -->
    <panel id="proxypanel">
        <field type="title" size="2" txt="Proxy Settings" id="input.proxypanel.title"/>
        <field type="radio" variable="project.proxy.type">
            <description txt="Select the proxy type" id="description.radio"/>
            <spec txt="Type: " id="input.smtp.server" size="25" set="">
                <choice txt="NO_PROXY" id="input.smtp.tls.radio.1" value="NO_PROXY" />
                <choice txt="PROXY_BASIC" id="input.smtp.tls.radio.2" value="PROXY_BASIC" set="true"/>
            </spec>                
        </field>
        <field type="text" variable="project.proxy.host" conditionid="condition.proxy.basic">
            <spec txt="Proxy Host:" id="input.proxypanel.host" size="25" set=""/>
        </field>
        <field type="text" variable="project.proxy.port" conditionid="condition.proxy.basic">
            <spec txt="Proxy Port:" id="input.proxypanel.port" size="6" set=""/>
        </field>
        <field type="text" variable="project.proxy.login" conditionid="condition.proxy.basic">
            <spec txt="Proxy Username:" id="input.proxypanel.login" size="20" set="">                               
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.proxy.login.plain"/>
            </spec>    
        </field>
        <field type="password" variable="project.proxy.pwd" conditionid="condition.proxy.basic">
            <spec>
                <pwd txt="Proxy Password:" size="20" set="" id="input.proxypanel.password"/>
                <pwd txt="Retype Password:" size="20" set="" id="input.proxypanel.retypepassword"/>
                
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.proxy.pwd.plain"/>
            </spec>
            <validator class="com.izforge.izpack.panels.userinput.validator.PasswordEqualityValidator" txt="Both keystore passwords must match." id="input.proxypanel.password.validator" />    
        </field>
    </panel>

    <!-- Datacite Settings -->
    <panel id="datacitepanel">
        <field size="2" txt="DataCite Settings" type="title" id="input.title.dbProp" />
        <field type="text" variable="project.inist.doi">
            <spec txt="Prefix: " id="input.smtp.server" size="7" set=""/>
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="input.stmp.server.validator" txt="server is a required field" />
        </field>         
        <field type="text" variable="project.inist.login">
            <spec txt="Login:" id="input.proxypanel.login" size="15" set="">                               
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.mail.identifier.plain"/>                            
            </spec>
        </field>   
        <field type="password" variable="project.inist.pwd">
            <spec>   
                <pwd txt="Password:" size="15" set="" id="input.db_pwd.label" />
                <pwd txt="Retype Password:" size="15" set="" id="input.db_repwd.label"/>                                            
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.mail.identifier.plain"/>                           
            </spec>
            <validator class="com.izforge.izpack.panels.userinput.validator.PasswordEqualityValidator" txt="Both keystore passwords must match." id="catalog.database.password.validator" />
        </field>                   
    </panel>

    <!-- Token settings -->    
    <panel id="tokenpanel">
        <field size="2" txt="Token Settings" type="title" id="input.title.dbProp" />        
        <field type="radio" variable="project.token.unit">
            <description txt="Select the unit the token duration." id="description.radio"/>
            <spec txt="Delay unit: " id="input.smtp.server" size="25" set="">
                <choice txt="Hour" id="input.smtp.tls.radio.1" value="10" />
                <choice txt="Month" id="input.smtp.tls.radio.2" value="5" set="true"/>
                <choice txt="Year" id="input.smtp.tls.radio.3" value="1" />
            </spec>                
        </field>
        <field type="text" variable="project.token.delay" set="1">
            <spec txt="Time: " id="input.smtp.server" size="10" set=""/>
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="input.stmp.server.validator" txt="server is a required field" />
        </field>               
    </panel>

    <!-- database panel -->
    <panel id="databasepanel">
        <field type="staticText" align="left"
               txt="You need to set an existing user and database" id="staticText.text"/>  
        <field type="space" />      
        <field size="2" txt="Database Settings" type="title" id="input.title.dbProp" />
        <field type="text" variable="project.db.hostname">
            <spec txt="Database host name: " set="localhost" id="input.database.hostname.label" size="15" />
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="catalog.database.name.validator" txt="hostname is a required field" />
        </field>
        <field type="text" variable="project.db.port">
            <spec txt="Database port: " id="input.database.port.label" size="15" set="5432" />
            <validator class="com.izforge.izpack.panels.userinput.validator.RegularExpressionValidator" txt="Database port must be a number" id="input.database.port.validator">
                <param name="pattern" value="\d+" />
            </validator>
        </field>
        <field type="text" variable="project.db.name">
            <spec txt="Database name: " id="input.database.name.label" size="15" set="doi" />
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="input.database.name.validator" txt="Database name is a required field" />
        </field>
        <field type="text" variable="project.db.schema">
            <spec txt="Schema name: " id="input.database.schema.label" size="15" set="doischema" />
        </field>
        <field type="text" variable="project.db.user">
            <spec size="15" txt="User" set="" id="input.db_us"/>
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="input.user.name.validator" txt="User name is a required field" />
        </field>
        <field type="password" align="left" variable="project.db.pwd">
            <spec>
                <pwd txt="Password:" size="15" set="" id="input.db_pwd.label" />
                <pwd txt="Retype Password:" size="15" set="" id="input.db_repwd.label"/>
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.db.pwd.plain"/>
            </spec>
            <validator class="com.izforge.izpack.panels.userinput.validator.PasswordEqualityValidator" txt="Both keystore passwords must match." id="catalog.database.password.validator" />
        </field>        
    </panel>
    
    <!-- LDAP -->
    <panel id="ldappanel">
        <field size="2" txt="LDAP Settings" type="title" id="input.title.dbProp" />
        <field type="text" variable="project.ldap.url">
            <spec txt="URL: " set="localhost" id="input.database.hostname.label" size="15" />
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="catalog.database.name.validator" txt="hostname is a required field" />
        </field>
        <field type="text" variable="project.ldap.user">
            <spec size="15" txt="Login" set="" id="input.db_us">
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.ldap.user.plain"/>              
            </spec>            
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="input.user.name.validator" txt="User name is a required field" />
        </field>
        <field type="Password" align="left" variable="project.ldap.pwd">
            <spec>
                <pwd txt="Password:" size="15" set="" id="input.db_pwd.label" />
                <pwd txt="Retype Password:" size="15" set="" id="input.db_repwd.label"/>
                <processor class="fr.cnes.doi.izpack.processor.PasswordEncryptionProcessor" backupVariable="project.ldap.pwd.plain"/>
            </spec>
            <validator class="com.izforge.izpack.panels.userinput.validator.PasswordEqualityValidator" txt="Both keystore passwords must match." id="catalog.database.password.validator" />
        </field> 
        <field type="text" variable="project.ldap.group">
            <spec txt="Group: " set="doiserver" id="input.database.hostname.label" size="15" />
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="catalog.database.name.validator" txt="hostname is a required field" />
        </field>    
        <field type="text" variable="project.ldap.user.admin">
            <spec txt="Administrator: " set="" id="input.database.hostname.label" size="15" />
            <validator class="com.izforge.izpack.panels.userinput.validator.NotEmptyValidator" id="catalog.database.name.validator" txt="hostname is a required field" />
        </field>  
        <!-- Skip validation in case customer has something wrong they want to fix later -->
        <field type="check" align="left" variable="skip.ldap.validation">
          <spec txt=" Skip LDAP validation (not recommended)" size="25" true="true" false="false" set="false"/>
        </field>                          
    </panel>   

</izpack:userinput>
